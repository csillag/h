(function(){window.DomTextMatcher=function(){function t(t){this.mapper=t}return t.prototype.setRootNode=function(t){return this.mapper.setRootNode(t)},t.prototype.setRootId=function(t){return this.mapper.setRootId(t)},t.prototype.setRootIframe=function(t){return this.mapper.setRootIframe(t)},t.prototype.setRealRoot=function(){return this.mapper.setRealRoot()},t.prototype.getAllPaths=function(){var t,e,r;return e=this.timestamp(),t=this.mapper.getAllPaths(),r=this.timestamp(),{time:r-e,paths:t}},t.prototype.getDefaultPath=function(){return this.mapper.getDefaultPath()},t.prototype.prepareSearch=function(t,e){var r,n;return null==e&&(e=!1),r=this.timestamp(),this.mapper.scan(t,e),n=this.timestamp(),n-r},t.prototype.searchExact=function(t,e,r,n,a){return null==e&&(e=!0),null==r&&(r=!1),null==n&&(n=null),null==a&&(a=!1),this.pm||(this.pm=new window.DTM_ExactMatcher),this.pm.setDistinct(e),this.pm.setCaseSensitive(r),this.search(this.pm,t,null,n,a)},t.prototype.searchRegex=function(t,e,r,n){return null==e&&(e=!1),null==r&&(r=null),null==n&&(n=!1),this.rm||(this.rm=new window.DTM_RegexMatcher),this.rm.setCaseSensitive(e),this.search(this.rm,t,null,r,n)},t.prototype.searchFuzzy=function(t,e,r,n,a,s,o){return null==r&&(r=!1),null==n&&(n=1e3),null==a&&(a=.5),null==s&&(s=null),null==o&&(o=!1),null==this.dmp&&(this.dmp=new window.DTM_DMPMatcher),this.dmp.setMatchDistance(n),this.dmp.setMatchThreshold(a),this.dmp.setCaseSensitive(r),this.search(this.dmp,t,e,s,o)},t.prototype.search=function(t,e,r,n,a){var s,o,p,i,h,l,u,c,m,f,d=this;if(null==n&&(n=null),null==a&&(a=!1),null==e)throw Error("Can't search for null pattern!");if(e=e.trim(),null==e)throw Error("Can't search an for empty pattern!");if(p=this.timestamp(),null!=n&&this.prepareSearch(n,a),i=this.timestamp(),null==this.mapper.corpus)throw Error("Not prepared to search! (call PrepareSearch, or pass me a path)");for(u=t.search(this.mapper.corpus,e,r),h=this.timestamp(),o=[],c=function(t){return o.push($.extend({},t,d.analyzeMatch(e,t),d.mapper.getMappingsForRange(t.start,t.end)))},m=0,f=u.length;f>m;m++)s=u[m],c(s);return l=this.timestamp(),{matches:o,time:{phase0_domMapping:i-p,phase1_textMatching:h-i,phase2_matchMapping:l-h,total:l-p}}},t.prototype.timestamp=function(){return(new Date).getTime()},t.prototype.analyzeMatch=function(t,e){var r;return r=this.mapper.corpus.substr(e.start,e.end-e.start),{found:r,exact:r===t}},t}()}).call(this),function(){angular.module("domTextMatcher",["domTextMapper"]).factory("domTextMatcher",["domTextMapper",function(t){return{getInstance:function(){return new DomTextMatcher(t.getInstance())}}}]).factory("domTextHiliter",function(){return new DomTextHiliter})}.call(this);